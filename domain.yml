version: '3.1'
intents:
- bot_challenge
- enter_token
- exactInput
- goodbye
- greet
- name&number
- enter_tokenOut
- enter_tokenIn
- stop
- introduce
- inform
- sendToken

entities:
- tokenIn
- tokenOut
- amountIn
- tokenInContract
- tokenOutContract
- addressOut

slots:
  tokenIn:
    type: text
    influence_conversation: true
    # mappings:
    # - type: from_entity
    #   entity: tokenIn
    # - intent:
    #   - inform
    #   type: from_text
    #   conditions:
    #   - active_loop: exactInput_form
    #     requested_slot: tokenIn     
    mappings:
      - type: from_entity
        entity: tokenIn
      - type: from_text
        conditions:
        - active_loop: exactInput_form
          requested_slot: tokenIn 
        - active_loop: sendToken_form
          requested_slot: tokenIn
  tokenOut:
    type: text
    influence_conversation: true
    # mappings:
    # - type: from_entity
    #   entity: tokenOut
    # - intent:
    #   - inform
    #   type: from_text
    #   conditions:
    #   - active_loop: exactInput_form
    #     requested_slot: tokenOut  
    mappings:
      - type: from_entity
        entity: tokenOut
      - type: from_text
        conditions:
        - active_loop: exactInput_form
          requested_slot: tokenOut 
  amountIn:
    type: float
    influence_conversation: true
    # mappings:
    # - type: from_entity
    #   entity: amountIn
    # - intent:
    #   - inform
    #   type: from_text
    #   conditions:
    #   - active_loop: exactInput_form
    #     requested_slot: amountIn
    mappings:
      - type: from_entity
        entity: amountIn
      - type: from_text
        conditions:
        - active_loop: exactInput_form
          requested_slot: amountIn
        - active_loop: sendToken_form
          requested_slot: amountIn
  tokenInContract:
    type: text
    influence_conversation: true
    # mappings:
    # - type: from_entity
    #   entity: tokenInContract
    # - intent:
    #   - inform
    #   type: from_text
    #   conditions:
    #   - active_loop: exactInput_form
    #     requested_slot: tokenInContract 
    mappings:
      - type: from_entity
        entity: tokenInContract
      - type: from_text
        conditions:
        - active_loop: exactInput_form
          requested_slot: tokenInContract
        - active_loop: sendToken_form
          requested_slot: tokenInContract
  tokenOutContract:
    type: text
    influence_conversation: true
    # mappings:
    # - type: from_entity
    #   entity: tokenOutContract
    # - intent:
    #   - inform
    #   type: from_text
    #   conditions:
    #   - active_loop: exactInput_form
    #     requested_slot: tokenOutContract 
    mappings:
      - type: from_entity
        entity: tokenOutContract
      - type: from_text
        conditions:
        - active_loop: exactInput_form
          requested_slot: tokenOutContract
  addressOut:
    type: text
    influence_conversation: true
    # mappings:
    # - type: from_entity
    #   entity: tokenOutContract
    # - intent:
    #   - inform
    #   type: from_text
    #   conditions:
    #   - active_loop: exactInput_form
    #     requested_slot: tokenOutContract 
    mappings:
      - type: from_entity
        entity: addressOut
      - type: from_text
        conditions:
        - active_loop: sendToken_form
          requested_slot: addressOut

forms:
  exactInput_form:
    required_slots:
    - tokenIn
    - tokenOut
    - amountIn
    - tokenInContract
    - tokenOutContract
  sendToken_form:
    required_slots:
    - tokenIn
    - amountIn
    - addressOut
    - tokenInContract

responses:
  utter_greet:
  - text: Hey! Sparky is here, what can I do for you?
  utter_ask_exactInput:
  - text: Tell me what to do
  utter_submit_exactInputForm:
  - text: |
      Please check oprderation carefully and sign with your wallet
      ---------------------------------------------------------- 
      TYPE of OPERATION: Standard Swap
      You Pay: {AmountIn} {TokenIn}(contract address: {TokenInContract})
      You Receive: {TokenOut}(contract address: {TokenOutContract})
  utter_goodbye:
  - text: Bye
  utter_stop:
  - text: Sure, previousactions have been teminated. Tell me what you want 
  utter_iamabot:
  - text: My name is Sparky, I am a trustless dex-trading tool
  utter_nlu_fallback:
  - text: I am not sure what you are talking about, please rephrase
  utter_ask_exactInput_form_tokenOut:
  - text: which token you intend to buy
  utter_ask_exactInput_form_tokenIn:
  - text: which token you would like to choose as the payment token
  utter_ask_exactInput_form_amountIn:
  - text: How many tokens you intend to pay

  utter_ask_sendToken_form_tokenIn:
  - text: which token you intend to send
  utter_ask_sendToken_form_amountIn:
  - text: How many tokens you intend to send
  utter_ask_sendToken_form_addressOut:
  - text: which address is the recepient?

  utter_submit_sendToken_form:
  - text: |
      Please check oprderation carefully and sign with your wallet
      ---------------------------------------------------------- 
      TYPE of OPERATION: Transfer Token
      You Send: {AmountIn} {TokenIn}(contract address: {TokenInContract})
      Recepient: {AddressOut}

  utter_introduce:
  - text: |
      I can help you do followings
      ----------------------------
      -> swap tokens on UniswapV3
      -> make transfers [under development]
      -> place limited order [under development]
      -> fork and front-run [under development]



actions:
- action_submit_exactInputForm
- validate_exactInput_form
- action_ask_exactInput_form_tokenInContract
- action_ask_exactInput_form_tokenOutContract
- action_clear_allSlot
- action_ask_exactInput_form_amountIn
- validate_sendToken_form
- action_submit_sendToken_form

- action_ask_sendToken_form_tokenInContract
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
